<form
  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 items-end mb-8 bg-white p-6 rounded-xl shadow-md border border-gray-200"
>
  <!-- Nombre -->
  <div class="flex flex-col">
    <label for="nombre" class="text-sm font-semibold text-gray-700 mb-1">
      Nombre
    </label>
    <div class="relative">
      <input
        id="nombre"
        type="text"
        name="nombre"
        [(ngModel)]="filtros.nombre"
        (ngModelChange)="onNombreChange($event)"
        placeholder="Buscar por nombre"
        class="w-full pl-10 pr-3 py-2 text-sm border rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
      />
      <div
        class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"
      >
        <svg
          class="w-4 h-4 text-gray-400"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M21 21l-4.35-4.35M16.65 16.65A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"
          />
        </svg>
      </div>
    </div>
  </div>

  <!-- Tipo de Elemento -->
  <div class="flex flex-col">
    <label for="elemento" class="text-sm font-semibold text-gray-700 mb-1">
      Tipo de Elemento
    </label>
    <select
      id="elemento"
      name="elemento"
      [(ngModel)]="filtros.elemento"
      (ngModelChange)="onSelectChange()"
      class="w-full px-3 py-2 text-sm border rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
    >
      <option [ngValue]="null">Todos</option>
      <option value="CARPETA">Carpeta</option>
      <option value="ARCHIVO">Archivo</option>
    </select>
  </div>

  <!-- Provincia -->
  <div class="flex flex-col">
    <label for="provinciaId" class="text-sm font-semibold text-gray-700 mb-1">
      Provincia
    </label>
    <select
      id="provinciaId"
      name="provinciaId"
      [(ngModel)]="filtros.provinciaId"
      (ngModelChange)="onSelectChange()"
      class="w-full px-3 py-2 text-sm border rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
    >
      <option [ngValue]="null">Todas</option>
      <option *ngFor="let provincia of provincias" [value]="provincia.id">
        {{ provincia.nombre }}
      </option>
    </select>
  </div>

  <!-- Equipo de Distribución -->
  <div class="flex flex-col">
    <label
      for="equipoDistribucion"
      class="text-sm font-semibold text-gray-700 mb-1"
    >
      Equipo de Distribución
    </label>
    <select
      id="equipoDistribucion"
      name="equipoDistribucion"
      [(ngModel)]="filtros.equipoDistribucion"
      (ngModelChange)="onSelectChange()"
      class="w-full px-3 py-2 text-sm border rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
    >
      <option [ngValue]="null">Todos</option>
      <option *ngFor="let equipo of equiposDistribucion" [value]="equipo">
        {{ equipo }}
      </option>
    </select>
  </div>
</form>

<!-- Loading State -->
<div *ngIf="isLoading" class="flex justify-center items-center min-h-[200px]">
  <div
    class="animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500 border-solid"
  ></div>
</div>

<!-- Error State -->
<div
  *ngIf="isError"
  class="bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded-md flex items-center gap-2"
  role="alert"
>
  <svg
    class="w-5 h-5 text-red-600"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      d="M12 9v2m0 4h.01M12 5.5a7 7 0 100 14 7 7 0 000-14z"
    />
  </svg>
  <div>
    <strong class="font-bold">Error:</strong>
    <span>{{ error }}</span>
  </div>
</div>

<!-- Main Content -->
<div
  *ngIf="!isLoading && !isError && elementos.length > 0"
  class="overflow-x-auto"
>
  <table class="min-w-full bg-white border border-gray-200">
    <thead class="bg-gray-100 text-gray-700">
      <tr>
        <th class="px-6 py-3 text-left font-semibold uppercase tracking-wide">
          Nombre
        </th>
        <th class="px-6 py-3 text-left font-semibold uppercase tracking-wide">
          Tipo
        </th>
        <th class="px-6 py-3 text-left font-semibold uppercase tracking-wide">
          Creado Por
        </th>
        <th class="px-6 py-3 text-left font-semibold uppercase tracking-wide">
          Fecha
        </th>
        <th class="px-6 py-3 text-left font-semibold uppercase tracking-wide">
          Detalles
        </th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-200">
      <tr *ngFor="let elemento of elementos" class="hover:bg-gray-50">
        <td class="px-6 py-4 whitespace-nowrap">
          <div class="flex items-center">
            <!-- Icon based on type -->
            <div class="flex-shrink-0 h-10 w-10">
              <svg
                *ngIf="elemento.elemento === 'CARPETA'"
                class="h-10 w-10 text-yellow-500"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"
                ></path>
              </svg>
              <svg
                *ngIf="elemento.elemento === 'ARCHIVO'"
                class="h-10 w-10 text-blue-500"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"
                ></path>
              </svg>
            </div>
            <div class="ml-4">
              <div class="text-sm font-medium text-gray-900">
                {{ elemento.nombre }}
              </div>
              <div class="text-sm text-gray-500">
                {{ elemento.carpetaPadre }}
              </div>
            </div>
          </div>
        </td>
        <td class="px-6 py-4 whitespace-nowrap">
          <span
            [ngClass]="{
              'px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800':
                elemento.elemento === 'CARPETA',
              'px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800':
                elemento.elemento === 'ARCHIVO'
            }"
          >
            {{ elemento.elemento }}
          </span>
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
          {{ elemento.creadoPor }}
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
          {{ elemento.creadoEl | date : "short" }}
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
          <ng-container *ngIf="elemento.elemento === 'CARPETA'">
            <span class="text-sm text-gray-600">
              {{ getCarpetaDetalles(elemento) }}
            </span>
          </ng-container>
          <ng-container *ngIf="elemento.elemento === 'ARCHIVO'">
            <span class="text-sm text-gray-600">
              {{ getArchivoExtension(elemento) }} -
              {{ getArchivoDetalles(elemento) | fileSize }}
            </span>
          </ng-container>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- No Data State -->
<div
  *ngIf="!isLoading && !isError && elementos.length === 0"
  class="text-center py-6 text-gray-500 bg-gray-50 rounded-md"
>
  <p class="text-base">No hay documentos aprobados para mostrar.</p>
</div>
