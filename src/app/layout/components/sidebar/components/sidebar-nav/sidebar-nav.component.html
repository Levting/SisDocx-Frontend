<main class="flex-1">
  <!-- Sección de Navegación -->
  <nav
    *ngFor="let menu of menuService.pagesMenu"
    aria-label="Navegación principal"
  >
    <!-- Título del grupo (visible solo cuando el sidebar está expandido) -->
    <div
      class="m-4 truncate text-xs font-medium uppercase tracking-widest text-gray-500"
      *ngIf="menuService.showSideBar"
    >
      <span class="text-muted-foreground/60 text-xs font-semibold">
        {{ menu.group }}
      </span>
    </div>

    <ul class="flex flex-col gap-1">
      <!-- Items del menú -->
      <li *ngFor="let item of menu.items">
        <div
          [ngClass]="getItemClasses(item)"
          [routerLink]="item.route"
          (click)="onItemClick()"
        >
          <ng-container *ngIf="!menuService.showSideBar; else expandedMenu">
            <div [ngClass]="getIconClasses(item)">
              <svg-icon
                *ngIf="item.icon"
                [src]="item.icon"
                [svgClass]="
                  'h-5 w-5 transition-transform duration-200 group-hover:scale-110'
                "
              />
            </div>
          </ng-container>
          <ng-template #expandedMenu>
            <div [ngClass]="getIconClasses(item)">
              <svg-icon
                *ngIf="item.icon"
                [src]="item.icon"
                [svgClass]="
                  'h-5 w-5 transition-transform duration-200 group-hover:scale-110'
                "
              />
            </div>
            <!-- Menú de Subitems -->
            <ng-container
              [ngTemplateOutlet]="item.children ? childMenu : parentMenu"
              [ngTemplateOutletContext]="{ item: item }"
            />
          </ng-template>

          <!-- Workaround:: Enable routerLink -->
          <ng-template #parentMenu let-item="item">
            <div
              class="flex h-10 cursor-pointer items-center justify-start rounded-sm flex-1"
            >
              <span
                class="ml-3 truncate text-sm font-medium tracking-wide focus:outline-none"
                [ngClass]="
                  isActive(item.route || '') ? 'text-blue-700' : 'text-gray-700'
                "
              >
                <!-- Ocultar cuando el sidebar este colapsado -->
                <div *ngIf="menuService.showSideBar">
                  {{ item.label }}
                </div>
              </span>
            </div>
          </ng-template>

          <!-- Workaround:: Disable routerLink -->
          <ng-template #childMenu let-item="item">
            <div
              class="flex h-10 cursor-pointer items-center justify-start rounded-sm flex-1"
            >
              <span
                class="ml-3 truncate text-sm font-medium tracking-wide focus:outline-none"
                [ngClass]="
                  isActive(item.route || '') ? 'text-blue-700' : 'text-gray-700'
                "
              >
                <!-- Ocultar cuando el sidebar este colapsado -->
                <div *ngIf="menuService.showSideBar">
                  {{ item.label }}
                </div>
              </span>
            </div>
          </ng-template>

          <!-- Tooltip mejorado -->
          <div
            class="fixed w-full z-[9999] pointer-events-none"
            *ngIf="!menuService.showSideBar"
          >
            <div
              class="bg-gray-900 text-white absolute left-14 top-1/2 -translate-y-1/2 w-auto min-w-max origin-left scale-0 rounded-md px-3 py-2 text-xs font-medium shadow-lg transition-all duration-200 group-hover:scale-100"
            >
              {{ item.label }}
              <!-- Flecha del tooltip -->
              <div
                class="absolute left-0 top-1/2 -translate-x-1 -translate-y-1/2 w-0 h-0 border-l-4 border-l-transparent border-r-4 border-r-transparent border-t-4 border-t-gray-900"
              ></div>
            </div>
          </div>
        </div>
      </li>
    </ul>

    <div class="pt-4" *ngIf="menu.separator">
      <hr class="border-gray-200 border-dashed" />
    </div>
  </nav>
</main>
